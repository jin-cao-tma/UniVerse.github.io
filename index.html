<!DOCTYPE html>
<!-- python .\scripts\tools\compress_videos.py --data_root "C:\Users\56295\OneDrive - xudenden\418\Long Volumetric Video\Long Volumetric Video Materials\videos" --videos_dir demo --output_dir demo_x0.5 --vcodec libx264 --pix_fmt yuv420p --tag "" --preset "" --crf 28 --resize 0.5 -->
<html lang="en">

<head>
  <meta content="UniVerse" name="title" />
  <meta content="This paper aims to address the challenge of reconstructing 3D scene from inconsistent multi-view images." name="description" />
  <meta content="Computer Vision, Computer Graphics, NeRF, 3D Gaussian Splatting, Novel View Synthesis, Freeviewpoint Video" name="keywords" />
  <meta content="index, follow" name="robots" />
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
  <meta content="English" name="language" />
  <meta content="Jin Cao, Hongrui Wu, Ziyong Feng, Hujun Bao, Xiaowei Zhou, Sida Peng" name="author" />
  <title>UniVerse</title>
  <!-- Bootstrap -->
  <script src="js/video_comparison.js"></script>
  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="js/bootstrap-4.4.1.js"></script>

  <link rel="icon" href="images/icon.png" type="image/png">
  <link href="css/bootstrap-4.4.1.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/brands.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/solid.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/fontawesome.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;700;800;900&amp;display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" rel="stylesheet" />
  <!-- <link href="img/favicon.svg" rel="icon" sizes="any" type="image/svg+xml" /> -->

  <script src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js"></script>

  <style>
    code {
      white-space: pre-wrap;
    }

    body {
      font-family: 'Jost';
      font-weight: 500;
      font-size: 1.25em;
    }

    h1 {
      font-size: 2.25em;
    }

    h2 {
      font-size: 1.75em;
    }

    h3 {
      font-size: 1.5em;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-weight: bolder;
    }

    b {
      font-weight: bolder;
    }

    strong {
      font-weight: bold;
    }

    section>h5 {
      padding-bottom: 30px;
    }

    .col-12>h3 {
      padding-top: 30px;
    }

    .results-section {
      padding-bottom: 30px;
    }

    .carousel-control-prev,
    .carousel-control-next {
      background-color: rgba(0, 0, 0, 0.5);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
    }

    .carousel-control-prev {
      left: 25px;
    }

    .carousel-control-next {
      right: 25px;
    }

    .carousel-indicators {
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      bottom: 10%;
      left: 90%;

      /* Adjust vertical position */
      text-align: center;
      /* Center the content horizontally */
      margin: 0;
      padding: 0;
      list-style: none;
    }

    .carousel-indicators li {
      background-color: transparent;
      /* Hide the default Bootstrap indicators */
      border: none;
      /* Remove border */
      margin: 0 25px;
      display: inline-block;
    }

    .indicator-dot {
      display: inline-block;
      width: 15px;
      height: 15px;
      text-indent: -999px;
      border: none;
      border-radius: 10px;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .row.sm-gutters {
      margin-right: 5px;
      margin-left: 5px;
      margin-top: 5px;
      margin-bottom: 5px;
    }

    .row.sm-gutters>.col-md-4 {
      padding-right: 5px;
      padding-left: 5px;
      padding-top: 5px;
      padding-bottom: 5px;
    }

    .row.sm-gutters>.col-md-6 {
      padding-right: 5px;
      padding-left: 5px;
      padding-top: 5px;
      padding-bottom: 5px;
    }

    .row.sm-gutters>.col-md-12 {
      padding-top: 5px;
      padding-bottom: 5px;
      padding-right: 5px;
      padding-left: 5px;
    }

    .zoom-element {
      transition: transform 0.2s ease-in-out;
    }

    .zoom-element:hover {
      transform: scale(1.25);
    }

    video,
    iframe {
      border-radius: 10px;
      padding: 0px;
      margin: 0px;
    }

    .comparison-canvas {
      border-radius: 10px;
      padding: 0px;
      margin: 0px;
    }

    .a16x9 {
      aspect-ratio: 16/9;
    }

    .a4x3 {
      aspect-ratio: 4/3;
    }

    .a1932 {
      aspect-ratio: 1932/1276;
    }

    .a1x1 {
      aspect-ratio: 1;
    }
    
    .a-vertical {
      aspect-ratio: 16 / 9;
    }

    .a085 {
      aspect-ratio: 1430/1678;
    }

    .a133 {
      aspect-ratio: 1352/1014;
    }

    .a1875 {
      aspect-ratio: 1920/1024;
    }

    .carousel-video-container {
      aspect-ratio: 16 / 9;
      background-color: transparent;
      display: flex;
      align-items: center;
      justify-content: center;
      max-width: 600px;
      margin: 0 auto;
    }
  </style>
  <script>

  </script>
  </link>
</head>

<body>
  <!-- cover -->
  <section>
    <div class="jumbotron text-center mt-0">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <!-- <h1 style="font-weight: bold">
              <b>
                FreeTimeGS: <span style="color: #00A2FF">Free Gaussian Primitives</span> at <span style="color: #FF8495">Anytime Anywhere</span> for Dynamic Scene Reconstruction
                Representing <span style="color: #c68b5b">Long Volumetric Video</span>
                <br />
                with <span style="color: #6589bf">Temporal Gaussian Hierarchy</span>
              </b>
            </h1> -->
            <h1 style="font-size: 48px;">
              <img src="images/icon.png" alt="logo" style="height: 48px; vertical-align: middle; margin-right: 2px;"> UniVerse: Unleashing the <span style="color: #FF8495">Scene Prior </span> of Video Diffusion Models for Robust Radiance Field Reconstruction
            </h1>
  
            <!-- <h4 style="color:#5a6268; font-weight: bold;">SIGGRAPH Asia 2024 (TOG)</h4> -->
            <h4 style="color:#5a6268; font-weight: bold;">ICCV 2025</h4>
            <hr>
            <a href="https://jin-cao-tma.github.io/" target="_blank">Jin Cao<sup>1</sup><sup>*</sup></a>
            <a href="https://onehfr.github.io/" target="_blank">Hongrui Wu<sup>2</sup><sup>*</sup></a>
            <a href="" target="_blank">Ziyong Feng<sup>3</sup></a>

            <a href="http://www.cad.zju.edu.cn/home/bao/" target="_blank">Hujun Bao<sup>1</sup></a>
            <a href="https://xzhou.me" target="_blank">Xiaowei Zhou<sup>1</sup>
              <a href="https://pengsida.net" target="_blank">Sida Peng<sup>1</sup><sup>x</sup></a>

            </a>
            <p>
              <sup>1</sup>Zhejiang University&nbsp;&nbsp;&nbsp;&nbsp;<sup>2</sup>Tongji University&nbsp;&nbsp;&nbsp;&nbsp;<sup>3</sup>Deep Glint 
              <br />
              <span style="color: #5a6268;">
                <sup>*</sup>Equal Contribution&nbsp;&nbsp;&nbsp;&nbsp;<sup>x</sup>Corresponding Author
              </span>
            </p>
            <div class="row justify-content-center">
              <!-- <div class="column">
                <p class="mb-5"> -->
                  <!-- <a class="btn btn-large btn-light" href="https://drive.google.com/file/d/1J9Hl7KPMOkBmrt6UTFf_u9sQcjbblILA/view?usp=sharing" role="button" target="_blank"> -->
                  <!-- <a class="btn btn-large btn-light" href="./files/FreeTimeGS.pdf" role="button" target="_blank">
                    <i class="fa fa-file-pdf-o"></i>
                    <b>Paper</b>
                  </a>
                </p>
              </div> -->
              <div class="column">
                <p class="mb-5">
                  <a class="btn btn-large btn-light" href="https://arxiv.org/abs/2510.01669" role="button" target="_blank">
                    <i class="ai ai-arxiv"></i>
                    <b>Paper</b>
                  </a>
                </p>
              </div>


              <div class="column">
                <p class="mb-5">
                  <a class="btn btn-large btn-light" href="https://github.com/zju3dv/UniVerse" role="button" target="_blank">
                    <i class="fa fa-github"></i>
                    <b>Code</b>
                  </a>
                </p>
              </div>


            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section>
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-12 text-center">
          <b style="color: #8899a5">
            Making inconsistent images consistent before reconstruction.
          </b>


          <div class="carousel slide" data-interval="100000" data-ride="carousel" id="demo-carousel">
            <div class="carousel-inner">
              <div class="carousel-item active">
                <div class="row sm-gutters">
                  <div class="col-md-12">
                    <div class="carousel-video-container">
                      <video autoplay class="" loop muted playsinline controls aria-controls width="100%" src="./images/teaser_universe_cropped.mp4">
                      </video>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>

  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h3>Abstract</h3>
          <hr style="margin-top: 0px" />
          <img src="img/teaser.jpg" width="100%" />
          <div style="margin-bottom: 20px;"></div>
          <p style="text-align: justify; text-justify: inter-word;">

            This paper tackles the challenge of <b>robust reconstruction</b>, i.e., the task of reconstructing a 3D scene from a set of inconsistent multi-view images. Some recent works have attempted to simultaneously remove image inconsistencies and perform reconstruction by integrating image degradation modeling into neural 3D scene representations.However, these methods rely heavily on dense observations for robustly optimizing model parameters.To address this issue, we propose to <b>decouple robust reconstruction into two subtasks</b>: restoration and reconstruction, which naturally simplifies the optimization process.To this end, we introduce UniVerse, a unified framework for robust reconstruction based on a video diffusion model. Specifically, UniVerse first converts inconsistent images into initial videos, then uses a specially designed video diffusion model to restore them into consistent images, and finally reconstructs the 3D scenes from these restored images.Compared with case-by-case per-view degradation modeling, the diffusion model learns a general scene prior from large-scale data, making it applicable to diverse image inconsistencies.Extensive experiments on both synthetic and real-world datasets demonstrate the strong generalization capability and superior performance of our method in robust reconstruction. Moreover, UniVerse can control the style of the reconstructed 3D scene.

        </p>
        </div>
      </div>
    </div>
  </section>

  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h3>Method</h3>
          <hr style="margin-top: 0px" />
          <img src="img/pipeline.jpg" width="100%" style="margin-bottom: 20px;"/>
          <p style="text-align: justify; text-justify: inter-word;">
            Given a set of inconsistent images, we first convert them into an initial video. We then use SAM to identify transient occlusions and generate inpainting masks. These masks are used to set the occluded pixels in the initial video to zero. Next, we encode the video into latents using a VAE Encoder. After setting one image as the style image and assigning it style mask, we concatenate the style masks, inpainting masks, latents, and randomly sampled Gaussian noise along the channel dimension and feed them into the U-Net. For each masked input image, we obtain semantic embeddings using the CLIP image encoder and aggregate them via the Multi-input Query Transformer to form a global semantic embedding. This embedding guides the U-Net in the video generation process. Finally, the U-Net output is decoded by the VAE Decoder to produce the restored video, from which we extract the consistent images and reconstruct a high-quality 3D scene. If too many images for the VDM to restore at once, we iteratively restore them in batches as described.
          </p>
        </div>
      </div>
    </div>
  </section>



  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h3>Baseline Comparisons</h3>
          <hr style="margin-top: 0px" />
        </div>
      </div>
    </div>
  </section>

  <section class="results-section">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <h5>
            <button aria-controls="comp-render" aria-expanded="false" class="btn btn-primary" data-target="#comp-render" data-toggle="collapse" id="comp-render-button" type="button">
              &nbsp;Click to Expand&nbsp;
            </button>
            Comparisons with <b><a href="https://jonbarron.info/zipnerf/">ZipNerf</a></b>, <b><a href="https://bilarfpro.github.io/">Bilarf</a></b> and <b><a href="https://github.com/SuLvXiangXin/zipnerf-pytorch">ZipNerf w/ GLO</a></b>
          </h5>
        </div>
      </div>
      <div class="collapse" id="comp-render">
        <div class="col-md-12">
          <div class="row sm-gutters">

            <div class="col-md-4">
              <video class="a-vertical" autoplay muted playsinline controls width="100%" src="./images/room_comparison.mp4">
              </video>
            </div>
            <div class="col-md-4">
              <video class="a-vertical" autoplay muted playsinline controls width="100%" src="./images/fern_comparison.mp4">
              </video>
            </div>
            <div class="col-md-4">
              <video class="a-vertical" autoplay muted playsinline controls width="100%" src="./images/comparison_horns.mp4">
              </video>
            </div>

<!-- 
            <div class="col-md-12 zoom-element">
              <video class="a16x9" data-desktop-vid1="https://vultr.zhenx.me/longvolcap.assets/comp/actor1_4_compare_comp.mp4" data-desktop-vid2="https://raw.githubusercontent.com/dendenxu/longvolcap.assets/main/comp/actor1_4_compare_comp.mp4" data-mobile-vid1="https://vultr.zhenx.me/longvolcap.assets/comp_x0.5/actor1_4_compare_comp.mp4" data-mobile-vid2="https://raw.githubusercontent.com/dendenxu/longvolcap.assets/mobile/mai/comp_x0.5/actor1_4_compare_comp.mp4" loop muted playsinline controls aria-controls poster="img/spinner.svg" preload="none" width="100%">
              </video>
            </div>

            <div class="col-md-12 zoom-element">
              <video class="a16x9" data-desktop-vid1="https://vultr.zhenx.me/longvolcap.assets/comp/actor5_6_compare_comp.mp4" data-desktop-vid2="https://raw.githubusercontent.com/dendenxu/longvolcap.assets/main/comp/actor5_6_compare_comp.mp4" data-mobile-vid1="https://vultr.zhenx.me/longvolcap.assets/comp_x0.5/actor5_6_compare_comp.mp4" data-mobile-vid2="https://raw.githubusercontent.com/dendenxu/longvolcap.assets/mobile/mai/comp_x0.5/actor5_6_compare_comp.mp4" loop muted playsinline controls aria-controls poster="img/spinner.svg" preload="none" width="100%">
              </video>
            </div> -->

          </div>
        </div>
      </div>
    </div>
  </section>

  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h3>Further Applications</h3>
          <hr style="margin-top: 0px" />
        </div>
      </div>
    </div>
  </section>

  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h4>Style Control</h4>
          <hr style="margin-top: 0px" />
          <img src="img/style_control.png" width="100%" style="margin-bottom: 20px;" />
          <p style="text-align: justify; text-justify: inter-word;">
            The style of the restored images, and consequently the reconstructed 3D scenes, is determined by the style image. By changing the style image, we can alter the style of the entire reconstructed 3D scene
          </p>
        </div>
      </div>
    </div>
  </section>

  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h4>Restore Sparse Inconsistent Images</h4>
          <hr style="margin-top: 0px" />
          <img src="img/sparse.png" width="100%" style="margin-bottom: 20px;" />
          <p style="text-align: justify; text-justify: inter-word;">
            UniVerse focuses on making images consistent rather than generating new views. Thus, even after restoring very sparse input images to a consistent state, reconstruction may still fail due to insufficient views. This issue can be easily resolved by using a generative novel view synthesis model like ViewCrafter. As shown in the above figure, given 2 inconsistent input images, <a href="https://drexubery.github.io/ViewCrafter/">ViewCrafter</a> synthesizes distorted novel views with strange occlusions. After the images are restored via UniVerse, the novel views synthesized by <a href="https://drexubery.github.io/ViewCrafter/">ViewCrafter</a> become consistent. In other words, as a restoration model, UniVerse can serve as a pre-processor for other models, enabling robust reconstruction.
          </p>
        </div>
      </div>
    </div>
  </section>

  
  <!-- citing -->
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        </br>
        </br>
        <h3>Citation</h3>
        <hr style="margin-top: 0px" />
        <pre style="background-color: #e9eeef; padding: 1.5em 1.5em; border-radius: 20px; font-size: 0.75em;">
<code>

@misc{cao2025universeunleashingsceneprior,
  title={UniVerse: Unleashing the Scene Prior of Video Diffusion Models for Robust Radiance Field Reconstruction}, 
  author={Jin Cao and Hongrui Wu and Ziyong Feng and Hujun Bao and Xiaowei Zhou and Sida Peng},
  year={2025},
  eprint={2510.01669},
  archivePrefix={arXiv},
  primaryClass={cs.CV},
  url={https://arxiv.org/abs/2510.01669}, 
}
</code></pre>
        <hr />
      </div>
    </div>
  </div>



  <footer class="text-center" style="margin-bottom: 10px">
    Thanks to
    <a href="https://zhenx.me/" target="_blank">Zhen Xu</a>
    for the website template, which can be found
    <a href="https://github.com/zju3dv/zju3dv.github.io/tree/master/longvolcap" target="_blank">here</a>.
  </footer>
  <!-- Default Statcounter code for Long Volumetric Video
http://zju3dv.github.io/longvolcap -->
  <!-- <script type="text/javascript">
    var sc_project = 13068940;
    var sc_invisible = 1;
    var sc_security = "a17e5a49"; 
  </script>
  <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
  <noscript>
    <div class="statcounter"><a title="web statistics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/13068940/0/a17e5a49/1/" alt="web statistics" referrerPolicy="no-referrer-when-downgrade"></a></div>
  </noscript> -->
<!-- Default Statcounter code for freetimegs
https://zju3dv.github.io/freetimegs/ -->
<!-- <script type="text/javascript">
    var sc_project=13140674; 
    var sc_invisible=1; 
    var sc_security="64aa968e"; 
    </script>
    <script type="text/javascript"
    src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript><div class="statcounter"><a title="Web Analytics"
    href="https://statcounter.com/" target="_blank"><img class="statcounter"
    src="https://c.statcounter.com/13140674/0/64aa968e/1/" alt="Web Analytics"
    referrerPolicy="no-referrer-when-downgrade"></a></div></noscript> -->
    <!-- End of Statcounter Code -->
  <!-- End of Statcounter Code -->
<!-- Default Statcounter code for FreeTimeGs
https://zju3dv.github.io/freetimegs/ -->
<!-- <script type="text/javascript">
    var sc_project=13141873; 
    var sc_invisible=1; 
    var sc_security="63e27315"; 
    </script>
    <script type="text/javascript"
    src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript><div class="statcounter"><a title="Web Analytics"
    href="https://statcounter.com/" target="_blank"><img class="statcounter"
    src="https://c.statcounter.com/13141873/0/63e27315/1/" alt="Web Analytics"
    referrerPolicy="no-referrer-when-downgrade"></a></div></noscript> -->
    <!-- End of Statcounter Code -->
<!-- Default Statcounter code for FTGS https://zju3dv.github.io/freetimegs/ -->
<script type="text/javascript">
    var sc_project=13141888; 
    var sc_invisible=1; 
    var sc_security="f2d1ccf4"; 
    </script>
    <script type="text/javascript"
    src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript><div class="statcounter"><a title="Web Analytics"
    href="https://statcounter.com/" target="_blank"><img class="statcounter"
    src="https://c.statcounter.com/13141888/0/f2d1ccf4/1/" alt="Web Analytics"
    referrerPolicy="no-referrer-when-downgrade"></a></div></noscript>
    <!-- End of Statcounter Code -->
  <script>
    var buttonIds = [
      'slowmotion-demos-button',
      'street-demos-button',
    //   'mobilestage-demos-button',
    //   'n3dv-demos-button',
    //   'panoptic-demos-button',
    //   'enerfoutdoor-demos-button',
      'vr-demos-button',
      'comp-render-button',
     /* ...other button ids... */];
    var sectionIds = [
      'slowmotion-demos',
      'street-demos',
    //   'mobilestage-demos',
    //   'n3dv-demos',
    //   'panoptic-demos',
    //   'enerfoutdoor-demos',
      'vr-demos',
      'comp-render',
     /* ...other section ids... */];
    for (var i = 0; i < buttonIds.length; i++) {
      (function (index) {
        var button = document.getElementById(buttonIds[index]);
        var section = document.getElementById(sectionIds[index]);
        button.addEventListener('click', function () {
          if (section.classList.contains('show')) {
            button.innerText = '\u00a0Click to Expand\u00a0';
            var videos = section.getElementsByTagName('video');
            for (var j = 0; j < videos.length; j++) {
              if (videos[j].readyState >= HTMLMediaElement.HAVE_CURRENT_DATA) {
                videos[j].pause();
              }
            }
          } else {
            button.innerText = 'Click to Collapse';
            var videos = section.getElementsByTagName('video');
            for (var j = 0; j < videos.length; j++) {
              videos[j].play();
            }
          }
        });
      })(i);
    }

    document.addEventListener("DOMContentLoaded", function () {
      renderMathInElement(document.body, {
        delimiters: [
          { left: "$", right: "$", display: false },
          { left: "$$", right: "$$", display: true }
        ]
      });
    });


    function handleCarouselSlide(event) {
      // Reference to the current carousel
      var currentCarousel = $(event.target);

      // Check each video in the current carousel
      currentCarousel.find('video').each(function () {
        var isVideoInActiveItem = $(this).closest('.carousel-item').hasClass('active');
        if (isVideoInActiveItem) {
          if (this.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA) {
            this.height = (this.videoHeight / this.videoWidth) * $(this).parent().width();
          }
          this.play();
        } else {
          if (this.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA) {
            this.pause();
          }
        }
      });
    }

    $('.carousel').on('slid.bs.carousel', handleCarouselSlide);

    $(document).ready(function () {
      $('[data-toggle="tooltip"]').tooltip({delay: { "show": 200, "hide": 0 }});
      $('video').each(function () {
        var $video = $(this);
        var $carousel = $video.closest('.carousel');
        if ($carousel.length > 0) {
          $video.on('ended', function () {
            $carousel.carousel('next');
          });
        }
      });
    });

    function updateVideoShape() {
      this.height = (this.videoHeight / this.videoWidth) * $(this).parent().width();
    }

    // fix the element's width and height properties to the current video ones
    $("video").each(function () {
      if (!this.classList.contains('comparison-video')) {
        $(this).on('loadeddata', updateVideoShape);
      }
    });

    // $("#renbody-results-button").click()
    document.addEventListener("DOMContentLoaded", function () {
      // Get all videos
      var videos = document.querySelectorAll('video');

      // Add source to video tag
      function addSourceToVideo(element, src) {
        var source = document.createElement('source');
        source.src = src;
        source.type = 'video/mp4';
        element.appendChild(source);
      }

      // Determine screen size and select appropriate videos
      function whichSizeVideo(element) {
        var windowWidth = window.innerWidth || window.innerWidth;
        var prefix = windowWidth > 1200 ? "desktop" : "mobile";

        // Get all data attributes for the given prefix (e.g., data-mobile-vid1, data-mobile-vid2, ...)
        var i = 1;
        while (element.dataset[prefix + "Vid" + i]) {
          addSourceToVideo(element, element.dataset[prefix + "Vid" + i]);
          i++;
        }
      }

      // Initialize only if the page has videos
      function videoBandwidth() {
        if (videos) {
          videos.forEach(whichSizeVideo);
        }
      }
      videoBandwidth();

      // FIXME: this is not working yet
      function videoSize() {
        if (videos) {
          videos.forEach(updateVideoShape);
        }
      }
      // Listen to window resize
      window.onresize = videoSize;

      setInterval(function () {
        // Select all comparison-video type videos
        let videos = document.querySelectorAll('.comparison-video');

        videos.forEach(video => {
          // If the id does not end with After
          if (!video.id.endsWith('After')) {
            resizeAndPlay(video);
          }
        });
      }, 10000);  // 每500毫秒检测一次

    });
  </script>
</body>

</html>
